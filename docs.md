Описание техпроцесса загрузки и отправки файлов с разграничением доступа:
1. В `main/models.py` размещается модель `File`. Данная модель имеет поле класса `FileField`, которое предназначено для
сохранения в него файла. Конструктор класса `FileField` имеет параметр `upload_to`, в который передается функция,
   возвращающая путь для сохранения файла.
   
2. Модуль `File` имеет полиморфную связь, благодаря которой данная модель связывается с другими моделями через внешний
ключ. Данное решение было выбрано, чтобы не создавать модель `File` для каждой модели, где возможна загрузка файла.
   
3. Метод get_file_path(), определенный в классе `File` возвращает путь для сохранения файла. Путь для сохранения
файла зависит от модели, связанной внешним ключом с `File`. Ссылка на класс связанной модели записана в атрибуте 
   `content_type`.
   
4. Сохранение файлов происходит в директорию, указанную в переменной `MEDIA_ROOT` из модуля `settings.py`.
По умолчанию это директория `data`, расположенная в корне Django проекта.

5. Для формирования ссылок на файлы используется путь, указанный в переменной `MEDIA_URL`, которая представляет
собой URL, указывающий на каталог с файлами `MEDIA_ROOT`. Данные ссылки будут использоваться для переходов по ним
   пользователей.
   
6. При переходе пользователя по ссылке, запрос будет смаршрутизирован на обработку функцией `check_file_permissions`,
которая проверит права пользователя на доступ к файлу. Если он не имеет прав доступа, будет возбуждено исключение
   `PermissionDenied`, пользователь получит в ответ HTTP 403. В случае наличия прав на доступ, пользователю будет
   отправлен файл, путь к которому будет сформирован путем конкатенации на основе переменной `SENDFILE_ROOT` (из модуля 
   `settings.py`) и пути к файлу (из HTTP запроса).
   
7. Django отправит к Nginx специально сформированный HTTP запрос, содержащий путь к файлу, сформированный на прошлом шаге,
   с заголовком `X-accel`. Nginx 'увидит', что запрос пришел от сервера localhost с заголовком `X-accel` и "отдаст" 
   файл пользователю.
   
8. Таким образом Django принимает запрос на загрузку файла, проверяет есть ли у пользователя права на доступ к данному
файлу. В случае наличия прав, подготавливает ответ, который обрабатывается Nginx. Nginx производит отдачу файла
   пользователю. В итоге: Django проверяет права, Nginx - выполняет работу по отдаче файла. Итог - каждый выполняет
   свою работу - ту, для которой он был создан.
   
9. В Nginx у нас имеется две директивы:
1) Общая ''. Для общего доступа к ресурсам портала.
2) /data с опцией private; Для доступа к директории с файлами только по запросу от сервера. Доступ к данной директории
возможен только с локального узла. Так же HTTP запрос должен содержать обязательный заголовок `X-accel`, содержащий
   путь к файлу, который требуется отдать пользователю.

10. Для загрузки файла пользователь обращается по пути, начинающемуся на /media, после обработки запроса он получает
файл, хранящийся по пути, начинающийся на /data. Это необходимо для корректной маршрутизации запросов пользователя к 
    файлам и ответов Django, содержащих путь к файлу.